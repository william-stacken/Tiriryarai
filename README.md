# Tiriryarai
![logo](Tiriryarai/favicon.ico)
A C# HTTPS man-in-the-middle proxy.

## Table of Contents
 - [1. Features](#1-features)
 - [2. Files](#2-files)
 - [3. How To Build](#3-how-to-build)
   - [3.1. Linux](#31-linux)
 - [4. Adding Plugins](#4-adding-plugins)
 - [5. How To Use](#5-how-to-use)
 - [6. License](#6-license)

## 1. Features
- Automated certificate creation for each host.
- Customized plugins for automated HTTP request and response modification.
- OCSP query support (No OCSP stapling).
- Certificate Revocation List (CRL) support.
- Logging of HTTP requests and responses.

## 2. Files
The program creates the following folders and files:
 - *logs*: Contains one log file for each host, named `<hostname>.log`, containing each request sent
           and response received from that host.
 - *RootCA.pfx*: PKCS12 file containing the Root CA certificate that will be used to sign
                 certificates generated by Tiriryarai. The Root CA certificate needs to be
                 installed in your client, refer to [5. How To Use](#5-how-to-use) for details.
                 The password to this file is `secret`.
 - *OcspCA.pfx*: PKCS12 file containing the OCSP CA certificate that will be used to sign
                 OCSP responses generated by Tiriryarai. The password to this file is `secret`.

They can be found in the application data folder, which is `$HOME/.config/Tiriryarai` on Linux.

## 3. How To Build
### 3.1 Linux
Install **Mono** from [here](https://www.mono-project.com/download/stable/#download-lin) and run `msbuild Tiriryarai.sln`

## 4. Adding Plugins
 - Add a new .NET Console application project to the solution.
 - Add a reference to the `Tiriryarai` project, `System.Web`, `System.Runtime.Config`, and `Mono.Security`.
 - Create a new class that implements the [`IManInTheMiddle`](Tiriryarai/Server/IManInTheMiddle.cs) interface.
 - In the main method, create an instance of the [`HttpsMitmProxy`](Tiriryarai/Server/HttpsMitmProxy.cs) class and call its `Start()` method
   by passing an instance of the class implementeing `IManInTheMiddle`, your IP address, and a port number.

[`TiriryaraiMitm`](TiriryaraiMitm) contains a dummy example plugin that can be used for reference.

## 5. How To Use
To use the proxy, you need to install its Root CA certificate. After Tiriryarai has started correctly,
open `http://<your-ip-address>:<your-port>/cert` to download it. From there, install it in your client.
You also need to configure your client to use the proxy.

## 6. License
Copyright (C) 2021 William Stacken√§s <w.stackenas@gmail.com>

This README file documents the use of Tiriryarai.

Tiriryarai is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

Tiriryarai is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
